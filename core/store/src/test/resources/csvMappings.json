{
  "class": "CsvElementGenerator",
  "header": [
    "Region Name (GO)",
    "ONS LACode",
    "ONS LA Name",
    "CP",
    "S Ref E",
    "S Ref N",
    "Road",
    "A-Junction",
    "A Ref E",
    "A Ref N",
    "B-Junction",
    "B Ref E",
    "B Ref N",
    "RCat",
    "iDir",
    "Year",
    "dCount",
    "Hour",
    "PC",
    "2WMV",
    "CAR",
    "BUS",
    "LGV",
    "HGVR2",
    "HGVR3",
    "HGVR4",
    "HGVA3",
    "HGVA5",
    "HGVA6",
    "HGV",
    "AMV"
  ],
  "firstRow": 1,
  "allFieldsRequired": true,
  "csvTransforms": [
    {
      "selection": [
        "Road",
        "A-Junction"
      ],
      "function": {
        "class": "Concat",
        "separator": ":"
      },
      "projection": [
        "A-Junction"
      ]
    },
    {
      "selection": [
        "Road",
        "B-Junction"
      ],
      "function": {
        "class": "Concat",
        "separator": ":"
      },
      "projection": [
        "B-Junction"
      ]
    },
    {
      "selection": [
        "A Ref E",
        "A Ref N"
      ],
      "function": {
        "class": "Concat",
        "separator": ","
      },
      "projection": [
        "A-Location"
      ]
    },
    {
      "selection": [
        "B Ref E",
        "B Ref N"
      ],
      "function": {
        "class": "Concat",
        "separator": ","
      },
      "projection": [
        "B-Location"
      ]
    },
    {
      "selection": [
        "PROPERTIES"
      ],
      "function": {
        "class": "CreateRoadTrafficFreqMap"
      },
      "projection": [
        "countByVehicleType"
      ]
    },
    {
      "selection": [
        "countByVehicleType"
      ],
      "function": {
        "class": "CallMethod",
        "method": "getTotal"
      },
      "projection": [
        "total-count"
      ]
    },
    {
      "selection": [
        "dCount"
      ],
      "function": {
        "class": "ToDate"
      },
      "projection": [
        "dCount"
      ]
    },
    {
      "selection": [
        "Hour"
      ],
      "function": {
        "class": "ToInteger"
      },
      "projection": [
        "Hour"
      ]
    },
    {
      "selection": [
        "dCount",
        "Hour"
      ],
      "function": {
        "class": "AddGivenHours"
      },
      "projection": [
        "startDate"
      ]
    },
    {
      "selection": [
        "startDate"
      ],
      "function": {
        "class": "DateToTimeBucketEnd",
        "bucket": "HOUR"
      },
      "projection": [
        "endDate"
      ]
    }
  ],
  "elements": [
    {
      "GROUP": "RegionContainsLocation",
      "DESTINATION": "ONS LA Name",
      "SOURCE": "Region Name (GO)"
    },
    {
      "GROUP": "LocationContainsRoad",
      "DESTINATION": "Road",
      "SOURCE": "ONS LA Name"
    },
    {
      "GROUP": "RoadHasJunction",
      "DESTINATION": "A-Junction",
      "SOURCE": "Road"
    },
    {
      "GROUP": "RoadHasJunction",
      "DESTINATION": "B-Junction",
      "SOURCE": "Road"
    },
    {
      "GROUP": "JunctionLocatedAt",
      "DESTINATION": "A-Location",
      "SOURCE": "A-Junction"
    },
    {
      "GROUP": "JunctionLocatedAt",
      "DESTINATION": "B-Location",
      "SOURCE": "B-Junction"
    },
    {
      "GROUP": "RoadUse",
      "countByVehicleType": "countByVehicleType",
      "endDate": "endDate",
      "DESTINATION": "B-Junction",
      "SOURCE": "A-Junction",
      "count": "total-count",
      "startDate": "startDate"
    },
    {
      "GROUP": "JunctionUse",
      "countByVehicleType": "countByVehicleType",
      "endDate": "endDate",
      "VERTEX": "A-Junction",
      "count": "total-count",
      "startDate": "startDate"
    },
    {
      "GROUP": "JunctionUse",
      "countByVehicleType": "countByVehicleType",
      "endDate": "endDate",
      "VERTEX": "B-Junction",
      "count": "total-count",
      "startDate": "startDate"
    }
  ],
  "followOnGenerator": {
    "class": "HyperLogLogPlusElementGenerator",
    "countProperty": "count",
    "edgeGroupProperty": "edgeGroup"
  }
}